{"version":3,"file":"main.js","mappings":"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","sources":["webpack://js_project/./src/index.js","webpack://js_project/./src/scripts/data.js"],"sourcesContent":["import {bubbleUp, coinFetch} from \"./scripts/data\";\n// import Example from \"./scripts/example\";\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n    // console.log(\"Hello world!\")\n    // const main = document.getElementById(\"main\")\n    // new Example(main); \n\n})\n\nasync function call(){\n    // const json = await coinFetch();\n    const coinInfo = await bubbleUp(); \n    // console.log(coinInfo);\n    // console.log(typeof coinInfo);\n}\n\ncall(); ","export function bubbleUp(){\n\n    // set the dimensions and margins of the graph\n    const width = 960\n    const height = 450\n\n    // append the svg object to the body of the page\n    const svg = d3.select(\"#my_dataviz\")\n    .append(\"svg\")\n        .attr(\"id\", \"chart\")\n        .attr(\"viewBox\", \"0 0 960 450\") //dynamic width & height\n        .attr(\"preserveAspectRatio\", \"xMidYMid meet\") //dynamic width & height\n\n        // Read data\n        d3.json(\"https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&order=market_cap_desc&per_page=250&page=1&sparkline=false\").then( function(data) {\n            \n        // add change properties to each coin whether they are up or down based on price_change_percentage_24h\n        data.map((el) => {\n            if (el.price_change_percentage_24h > 0) {\n                el['change'] = \"up\"\n            } else {\n                el['change'] = 'down'\n            }\n        })\n        \n        //huobi_btc weird data fetch correction\n        // data.map((el) => {\n        //     if (el.id === \"huobi-btc\") {\n        //         el.price_change_percentage_24h = 0\n        //     }\n        // })\n\n        console.log(data)\n        \n        // data.forEach(el => console.log(el.price_change_percentage_24h))\n\n        let downs = data.filter((el) => el.price_change_percentage_24h < 0)\n        let ups = data.filter((el) => el.price_change_percentage_24h > 0)\n        console.log(`${downs.length} downs `)\n        console.log(`${ups.length} ups `)\n        \n        //find the worst performing coin to use for size scaling\n        function bottom(arr) {\n            let result = {price_change_percentage_24h: 0}\n            for (let i = 0; i < arr.length; i++){\n                if (result.price_change_percentage_24h > arr[i].price_change_percentage_24h){\n                    result = arr[i]\n                }\n            }\n            return result;\n        }\n        \n        //find the best performing coin to use for size scaling\n        function top(arr) {\n            let result = {price_change_percentage_24h: 0}\n            for (let i = 0; i < arr.length; i++){\n                if (result.price_change_percentage_24h < arr[i].price_change_percentage_24h){\n                    result = arr[i]\n                }\n            }\n            return result;\n        }\n\n        //compare bottom and top and use for size scaling\n        function max(){\n            if (Math.abs(bottom(downs).price_change_percentage_24h) > top(ups).price_change_percentage_24h){\n                return Math.abs(bottom(downs).price_change_percentage_24h);\n            } else {\n                return top(ups).price_change_percentage_24h;\n            }\n        }\n        \n        console.log(bottom(downs))\n        console.log(top(ups))\n        \n        \n        // Color palette for change up/ down\n        const color = d3.scaleOrdinal()\n            .domain([\"down\", \"up\"])\n            .range([\"#fc0303\", \"#03fc2c\"]); // #046e22\n        \n        // Size scale for coin/bubbles based on top/worst performing coin\n        const size = d3.scaleLinear()\n            .domain([0, max()]) //use max of up/down to scale bubble size\n            .range([7, 50])  // circle will be between 7 and 55 px wide\n        \n        const textAlign = d3.scaleLinear()\n            .domain([0, max()]) //use max of up/down to textAlignment px\n            .range([1, 45])  // alignment will be between 1 - 45 additional px\n\n        const fontSize = d3.scaleLinear()\n            .domain([0, max()]) //added 10 to make it to appear within desire location\n            .range([3, 15])  // circle will be between 7 and 55 px wide\n\n        // How to stack bubbles if they are up/down\n        const y = d3.scaleOrdinal()\n            .domain([\"up\", \"down\"])\n            .range([0, 1000])\n        \n        //-------------------------------------\n        // create a tooltip\n        const Tooltip = d3.select(\"#my_dataviz\")\n            .append(\"div\")\n                .style(\"opacity\", 0)\n                .attr(\"class\", \"tooltip\")\n                .style(\"background-color\", \"white\")\n                .style(\"border\", \"solid\")\n                .style(\"border-width\", \"2px\")\n                .style(\"border-radius\", \"5px\")\n                .style(\"padding\", \"5px\")\n            \n            // Three function that change the tooltip when user hover / move / leave a cell\n        const mouseover = function(event, d) {\n            Tooltip\n                .style(\"opacity\", 1)\n        }\n        const mousemove = function(event, d) {\n            Tooltip\n                .html('<u>' + d.name + '</u>' + \"<br>\" + d.price_change_percentage_24h.toFixed(1) + '%')\n                .style(\"left\", (event.x/2+20) + \"px\")\n                .style(\"top\", (event.y/2-30) + \"px\")\n        }\n        const mouseleave = function(event, d) {\n            Tooltip\n                .style(\"opacity\", 0)\n        }\n        \n        // Initialize the circle: all located at the center of the svg area\n        const node = svg.append(\"g\")\n            .selectAll(\"circle\")\n            .data(data)\n            .join(\"circle\")\n            .attr(\"class\", \"node\")\n            .attr(\"r\", d => size(Math.abs(d.price_change_percentage_24h)))\n            .attr(\"cx\", width / 2)\n            .attr(\"cy\", height / 2)\n            .style(\"fill\", function(d) {return \"url(#\" + d.name.toLowerCase().replaceAll(\" \", \"-\") + \")\"})\n            .style(\"fill-opacity\", 1)\n            .attr(\"stroke\", d => color(d.change))\n            .style(\"stroke-width\", 2.5)\n            .on(\"mouseover\", mouseover) // What to do when hovered\n            .on(\"mousemove\", mousemove)\n            .on(\"mouseleave\", mouseleave)\n            .call(d3.drag() // call specific function when circle is dragged\n            .on(\"start\", dragstarted)\n            .on(\"drag\", dragged)\n            .on(\"end\", dragended))\n            ;\n        \n        const text = svg.selectAll(null)\n            .data(data)\n            .enter()\n            .append(\"text\")\n            .text(d => {if (d.price_change_percentage_24h < 0) {\n                    return `${d.price_change_percentage_24h.toFixed(1)}%`\n                } else if (d.price_change_percentage_24h > 0) {\n                    return `+${d.price_change_percentage_24h.toFixed(1)}%`\n                } else {\n                    return \"0%\"\n                }\n            })\n            .attr('font-size', d => fontSize(Math.abs(d.price_change_percentage_24h)))\n            .attr('text-anchor', 'middle')\n\n        const icon = svg.selectAll(\"coinImage\")\n            .data(data)\n            .enter()\n            .append(\"pattern\")\n            .attr(\"class\", \"coinImage\")\n            .attr(\"id\", function(d) {return d.name.toLowerCase().replaceAll(\" \", \"-\")})\n            .attr(\"height\", \"100%\")\n            .attr(\"width\", \"100%\")\n            .attr(\"patternContentUnits\", \"objectBoundingBox\")\n            .append(\"image\")\n            .attr(\"height\", 1)\n            .attr(\"width\", 1)\n            .attr(\"preserveAspectRatio\", \"none\")\n            .attr(\"xlink:href\", d => d.image)\n\n            let ticked = () => {\n                node.attr('cx', (data) => {\n                        return data.x\n                    })\n                    .attr('cy', (data) => {\n                        return data.y\n                    });\n            \n                text.attr('x', (data) => {\n                        return data.x\n                    })\n                    .attr('y', (data) => {\n                        return data.y + textAlign(Math.abs(data.price_change_percentage_24h))\n                    });\n            }\n\n        // Features of the forces applied to the nodes:\n        const simulation = d3.forceSimulation()\n            .force(\"x\", d3.forceX().strength(0.3).x( height / 2 )) //strength of bubbles if move horizontally\n            .force(\"y\", d3.forceY().strength(2).y( d => y(d.change) )) //strength of bubbles if move vertically, greens will float on top \n            .force(\"center\", d3.forceCenter().x(width / 2).y(height / 2)) // Attraction to the center of the svg area\n            .force(\"charge\", d3.forceManyBody().strength(.00000000001)) // Nodes are attracted one each other of value is > 0\n            .force(\"collide\", d3.forceCollide().strength(.7).radius(function(d){ return (size(Math.abs(d.price_change_percentage_24h))+5) }).iterations(5)) // Force that avoids circle overlapping\n            \n        // Apply these forces to the nodes and update their positions.\n        // Once the force algorithm is happy with positions ('alpha' value is low enough), simulations will stop.\n        simulation\n            .nodes(data)\n                .on(\"tick\", ticked);\n\n        // Drag Logic\n        function dragstarted(event, d) {\n            if (!event.active) simulation.alphaTarget(.01).restart();\n            d.fx = d.x;\n            d.fy = d.y;\n        }\n        function dragged(event, d) {\n            d.fx = event.x;\n            d.fy = event.y;\n        }\n        function dragended(event, d) {\n            if (!event.active) simulation.alphaTarget(.01);\n            d.fx = null;\n            d.fy = null;\n        }\n\n    })\n}\n\n\n"],"names":["document","addEventListener","async","svg","d3","select","append","attr","json","then","data","map","el","price_change_percentage_24h","console","log","downs","filter","ups","bottom","arr","result","i","length","top","max","Math","abs","color","scaleOrdinal","domain","range","size","scaleLinear","textAlign","fontSize","y","Tooltip","style","node","selectAll","join","d","width","height","name","toLowerCase","replaceAll","change","on","event","html","toFixed","x","call","drag","active","simulation","alphaTarget","restart","fx","fy","text","enter","image","forceSimulation","force","forceX","strength","forceY","forceCenter","forceManyBody","forceCollide","radius","iterations","nodes","ticked","bubbleUp"],"sourceRoot":""}